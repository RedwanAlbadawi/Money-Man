<html ng-app="OSM">
<head>
	<title>Open Street Maps using Clusterpoint</title>
	<!-- Angular Material CSS now available via Google CDN; version 0.8 used here -->
	<link rel="stylesheet" href="assets/css/style2.css">
</head>
<body layout="column" ng-controller="MainCtrl">
<div id="sidebar">
    <h1>Tork</h1>
    <p> A productivity tool to help businesses &professionals discover contracts for Goods & Services, Professional Services and Construction Services in the Toronto. 
    </p>
</div>
<div id="map" class="md-whiteframe-z2" flex>
</div>

<!--Plugins-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js" type="text/javascript"></script>
<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.js'></script>
<script src="angular-advanced-searchbox/dist/angular-advanced-searchbox-tpls.min.js"></script>
<script src="osm.js"></script>
<script
		src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js">â‰ˆ</script>
<script src="leaflet-sidebar/src/Sidebar.js">
</script>
<script>
a=5;
b=2;
c=a+b;
console.log(c);</script>
<script>
	$(document).ready(function () {
		var current_location = [43.6906, -79.4176];
		var radius = '1 km';

		// Loading map from mapbox
		// Setting view to london
		L.mapbox.accessToken = 'pk.eyJ1IjoiaW5zMWQzciIsImEiOiJmYTk5MjY4ZWMwNjVmNWVlZDdiZmQzOGE4ZWE2M2QxZCJ9.3aNjVwLZwEvRoZefs-vFvw';
		var map = L.mapbox.map('map', 'ins1d3r.a901164f')
				.setView(current_location, 12);

		// Create the marker group again
		var markerGroup = new L.MarkerClusterGroup().addTo(map);
		
		$.ajax({
			url       : 'https://api-us.clusterpoint.com/100719/tendercalls/_search?v=32',
			type      : 'POST',
			dataType  : 'json',
			data      : '{"query": "<viewentry_Id>60</viewentry_Id>", ' +
			'"docs": "19"}',
			beforeSend: function (xhr) {
				// Authentication
				xhr.setRequestHeader('Authorization', 'Basic ' + btoa('edgarwang95@gmail.com:yolotest'));
			},
			success   : function (data) {
				console.log(data);
				if (data.documents) {
					// Draw each marker
					for (var i = 0; i < data.documents.length; i++) {
						var marker = data.documents[i];
						console.log(marker.text);
						
					}
				}
				success(data);
			},
			fail      : function (data) {
				console.log("fail");
				alert(data.error);
				if (typeof fail != 'undefined') {
					fail(data);
					
				}
			}
		});

		var sidebar = L.control.sidebar('sidebar', {
			closeButton: true,
		    position: 'left'	
		});

		map.addControl(sidebar);

		setTimeout(function () {
			sidebar.show();
		}, 500);

	});

</script>

</body>
</html>